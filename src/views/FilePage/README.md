# 文件下载管理中心

## 概述

文件下载管理中心是一个专为自动爬虫平台设计的文件下载管理系统。它能够将普通的数据表转换为支持文件下载的表，并提供异步的文件下载功能。

## 页面结构

```
src/views/FilePage/
├── index.vue                    # 主页面
├── api/
│   └── files.js                # API接口文件
├── components/
│   ├── PluginCategories.vue    # 插件分类卡片
│   ├── FileRecordsList.vue     # 文件记录列表
│   ├── PluginConvertModal.vue  # 插件转换模态框
│   ├── DownloadTaskModal.vue   # 下载任务管理模态框
│   ├── StatsCard.vue           # 统计卡片
│   └── HelpTooltip.vue         # 帮助提示组件
└── README.md                   # 说明文档
```

## 主要功能

### 1. 插件管理

-   **插件列表显示**: 展示所有可下载模式的插件
-   **插件状态监控**: 实时显示插件的配置状态和下载状态
-   **插件转换**: 将普通插件转换为支持文件下载的插件

### 2. 文件记录管理

-   **文件列表展示**: 分页显示选中插件的所有文件记录
-   **文件筛选**: 支持按下载状态、文件类型等条件筛选
-   **文件搜索**: 支持按文件名搜索
-   **批量下载**: 支持多选文件进行批量 ZIP 下载

### 3. 下载任务管理

-   **任务启动/停止**: 控制文件下载任务的启动和停止
-   **实时监控**: 实时查看下载状态、进度和日志
-   **任务列表**: 统一管理所有下载任务

### 4. 统计数据

-   **可下载插件数量**: 显示总的可下载插件数
-   **已配置插件数量**: 显示已配置下载的插件数
-   **下载中任务数量**: 显示正在进行的下载任务数
-   **总文件数量**: 显示所有插件的文件总数

## 组件说明

### PluginCategories.vue

-   左侧插件分类卡片组件
-   显示所有可下载插件列表
-   支持插件选择和状态展示
-   提供转换插件和任务管理的快捷入口

### FileRecordsList.vue

-   右侧文件记录列表组件
-   显示选中插件的所有文件记录
-   支持文件搜索、筛选和分页
-   提供批量下载和单个文件下载功能

### PluginConvertModal.vue

-   插件转换配置模态框
-   三步式向导：选择插件 → 转换表结构 → 配置下载字段
-   支持动态加载表字段进行配置

### DownloadTaskModal.vue

-   下载任务管理模态框
-   提供任务启动、停止、监控功能
-   实时显示下载状态、进度和日志
-   自动刷新任务状态

## API 接口

所有 API 接口都在 `api/files.js` 中定义，包括：

-   插件管理相关接口
-   下载配置管理接口
-   下载任务控制接口
-   文件记录查询接口
-   批量下载接口

## 使用流程

1. **首次使用**:

    - 点击"转换插件"按钮
    - 选择要转换的普通插件
    - 转换表结构并配置下载字段

2. **管理下载**:

    - 在左侧选择已配置的插件
    - 查看右侧的文件记录列表
    - 使用"任务管理"控制下载任务

3. **批量下载**:
    - 在文件列表中选择需要的文件
    - 点击"批量下载"按钮
    - 系统自动创建 ZIP 并下载

## 注意事项

1. 只有已转换为文件下载模式的插件才会在左侧列表中显示
2. 批量下载的 ZIP 文件会在创建后立即下载，避免文件被清理
3. 下载任务支持并发，但每个插件同时只能运行一个下载任务
4. 系统会自动跳过已下载的文件，支持断点续传
5. 所有下载活动都会记录日志，可在任务管理中查看
